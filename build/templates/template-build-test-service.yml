steps:
  - task: UseDotNet@2
    inputs:
    version: '3.1.x'
    packageType: sdk
  - task: 333b11bd-d341-40d9-afcf-b32d5ce6f23b@2
  - task: DotNetCoreCLI@2
    inputs:
      command: 'restore'
      projects: '$(System.DefaultWorkingDirectory)\src\FactoryOrchestrator.sln'
  - task: DotNetCoreCLI@2
    inputs:
      command: 'build'
      arguments: '$(System.DefaultWorkingDirectory)\src\FactoryOrchestrator.sln --configuration $(BuildConfiguration)'
    displayName: 'dotnet build $(BuildConfiguration)'
    condition: succeeded()
  - task: DotNetCoreCLI@2
    inputs:
      command: test
      projects: |
        '**/IpcFramework/**/*Tests.csproj'
        '**/UnitTests/**/*Tests.csproj'
      arguments: '--configuration $(BuildConfiguration)'
    displayName: 'Run Unit Tests via dotnet test $(BuildConfiguration)'
