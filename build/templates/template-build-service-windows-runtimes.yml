# Builds, but does not publish, all supported Windows runtime variants of the Service
steps:
  - task: DotNetCoreCLI@2
    inputs:
      command: 'build'
      arguments: '$(System.DefaultWorkingDirectory)\src\Service\Microsoft.FactoryOrchestrator.Service.csproj -p:SolutionDir=$(System.DefaultWorkingDirectory)\src\ --configuration $(BuildConfiguration) -r win-x64 --no-dependencies --no-restore -fl -flp:LogFile=$(Build.ARTIFACTSTAGINGDIRECTORY)\BuildLogs\$(BuildConfiguration)_Service_x64_MsBuild.log;Verbosity=Detailed $(VERSIONSUFFIXDOTNET)'
    displayName: 'dotnet build for win-x64 runtime $(BuildConfiguration)'
    condition: succeeded()
  - task: DotNetCoreCLI@2
    inputs:
      command: 'build'
      arguments: '$(System.DefaultWorkingDirectory)\src\Service\Microsoft.FactoryOrchestrator.Service.csproj -p:SolutionDir=$(System.DefaultWorkingDirectory)\src\ --configuration $(BuildConfiguration) -r win-x86 --no-dependencies --no-restore -fl -flp:LogFile=$(Build.ARTIFACTSTAGINGDIRECTORY)\BuildLogs\$(BuildConfiguration)_Service_x86_MsBuild.log;Verbosity=Detailed $(VERSIONSUFFIXDOTNET)'
    displayName: 'dotnet build for win-x86 runtime $(BuildConfiguration)'
    condition: succeeded()
  - task: DotNetCoreCLI@2
    inputs:
      command: 'build'
      arguments: '$(System.DefaultWorkingDirectory)\src\Service\Microsoft.FactoryOrchestrator.Service.csproj -p:SolutionDir=$(System.DefaultWorkingDirectory)\src\ --configuration $(BuildConfiguration) -r win-arm --no-dependencies --no-restore -fl -flp:LogFile=$(Build.ARTIFACTSTAGINGDIRECTORY)\BuildLogs\$(BuildConfiguration)_Service_arm_MsBuild.log;Verbosity=Detailed $(VERSIONSUFFIXDOTNET)'
    displayName: 'dotnet build for win-arm runtime $(BuildConfiguration)'
    condition: succeeded()
  - task: DotNetCoreCLI@2
    inputs:
      command: 'build'
      arguments: '$(System.DefaultWorkingDirectory)\src\Service\Microsoft.FactoryOrchestrator.Service.csproj -p:SolutionDir=$(System.DefaultWorkingDirectory)\src\ --configuration $(BuildConfiguration) -r win-arm64 --no-dependencies --no-restore -fl -flp:LogFile=$(Build.ARTIFACTSTAGINGDIRECTORY)\BuildLogs\$(BuildConfiguration)_Service_arm64_MsBuild.log;Verbosity=Detailed $(VERSIONSUFFIXDOTNET)'
    displayName: 'dotnet build for win-arm64 runtime $(BuildConfiguration)'
    condition: succeeded()
  - publish: $(Build.ARTIFACTSTAGINGDIRECTORY)/BuildLogs/
    artifact: MSBuildLogs_Service_Win_Runtimes
    displayName: 'Publish msbuild log for windows runtimes'